# 管理员手册

**语言**: [English](./05_admin-guide.md) | 简体中文 | [繁體中文](./05_admin-guide_TW.md) | [Русский](./05_admin-guide_RU.md) | [فارسی](./05_admin-guide_FA.md)

本文档面向 EzPanel 的管理员，介绍后台各功能模块的操作方法。

![管理后台](../images/dashboard.png)

---

## 首次登录

默认管理员账号：

- **邮箱**: `admin@opine.work`
- **密码**: `admin123`

> **安全提醒**: 登录后请立即在「个人设置」中修改默认密码和邮箱，并开启两步验证。

---

## 用户管理

进入 **用户管理 → 用户列表**：

### 查看用户

| 操作 | 说明 |
|------|------|
| 搜索 | 支持按邮箱、用户 ID 搜索 |
| 筛选 | 按状态（正常 / 封禁）、套餐筛选 |
| 导出 | 导出 CSV / Excel 格式的用户数据 |

### 用户操作

- **查看详情**: 查看用户的订阅、订单、流量、余额等信息
- **编辑**: 修改邮箱、密码、余额、流量额度、到期时间
- **封禁 / 解封**: 禁止 / 允许用户登录和使用订阅
- **充值余额**: 直接为用户账户充值

### 手动重置密码

在用户详情中可直接设置新密码，无需验证旧密码。

---

## 套餐管理

进入 **套餐管理**：

### 创建套餐

| 字段 | 说明 |
|------|------|
| 套餐名称 | 显示给用户的名称 |
| 流量额度 | 每个计费周期可用流量（GB） |
| 计费周期 | 月付 / 季付 / 半年 / 年付，每个周期单独设置价格 |
| 库存 | -1 表示无限，设置正整数则有库存限制 |
| 设备数限制 | 同时在线设备数，0 表示不限制 |
| 速度限制 | 限速（Mbps），0 表示不限速 |
| 节点分组 | 该套餐可访问的节点分组 |
| 排序 | 数字越小越靠前 |
| 状态 | 上架 / 下架 |

### 套餐可见性

下架的套餐不会显示在用户端，但已购买的用户不受影响。

---

## 节点管理

进入 **系统管理 → 节点管理**：

### 创建节点

**基本配置**：

| 字段 | 说明 |
|------|------|
| 节点名称 | 显示给用户，支持 Emoji，如「🇭🇰 香港 01」 |
| 节点地址 | 节点服务器 IP 或域名 |
| 节点类型 | XrayM（推荐）/ XrayR |
| 节点分组 | 归属分组，影响套餐访问权限 |
| 速率限制 | 全局限速（Mbps），0 不限 |
| 设备限制 | 同时在线设备数，0 不限 |
| 排序 | 数字越小越靠前 |

**协议配置（XrayM）**：

点击「快速添加协议」选择预设组合，或手动添加协议：

- **传输层**: TCP / WebSocket / gRPC / HTTPUpgrade
- **安全层**: TLS / REALITY / 无
- **端口**: 各协议独立端口

配置完成后，将节点 ID 和通信密钥填入服务器上的 XrayM 配置文件，详见 [节点对接](./03_node-setup_CN.md)。

### 节点监控

进入 **系统管理 → 健康检查** 查看所有节点实时状态：

- 节点在线 / 离线状态
- CPU、内存、磁盘使用率
- 实时网络速率
- 当前在线用户数

点击节点可查看详细历史图表，数据每 10 秒自动刷新。

> 节点监控仅支持 XrayM，XrayR 仅上报流量数据。

---

## 订单管理（Pro 版）

进入 **订单管理**：

| 操作 | 说明 |
|------|------|
| 查看订单 | 支持按用户、状态、时间筛选 |
| 订单详情 | 查看支付记录、套餐信息 |
| 退款 | 将订单金额退还至用户余额 |
| 取消 | 取消未支付订单 |
| 手动完成 | 对线下支付的订单手动标记完成 |

---

## 优惠券管理（Pro 版）

进入 **营销 → 优惠券**：

| 字段 | 说明 |
|------|------|
| 优惠类型 | 固定金额 / 折扣百分比 |
| 使用限制 | 总使用次数 / 每人使用次数 |
| 适用套餐 | 留空则适用全部套餐 |
| 有效期 | 开始 / 结束时间 |
| 批量生成 | 可批量生成多个不同码的优惠券 |

---

## 工单管理（Pro 版）

进入 **工单管理**：

- 查看所有用户提交的工单
- 按状态筛选（待处理 / 处理中 / 已关闭）
- 回复工单，支持富文本
- 关闭工单或重新开启

---

## 知识库（Pro 版）

进入 **知识库**：

- 创建 FAQ 文章，支持 Markdown / 富文本
- 分类管理
- 设置文章可见范围（所有用户 / 仅付费用户）
- 用户可在「帮助」页面查看

---

## 邮件系统

### 配置 SMTP

进入 **系统设置 → 邮件设置**：

| 配置项 | 说明 |
|--------|------|
| SMTP 服务器 | 如 `smtp.gmail.com` |
| 端口 | 通常为 465（SSL）或 587（STARTTLS） |
| 用户名 | 发件邮箱账号 |
| 密码 | 邮箱密码或应用专用密码 |
| 发件人名称 | 显示给收件人的发件人名称 |

填写完成后点击「发送测试邮件」验证配置。

### 邮件模板

进入 **系统管理 → 邮件模板**，可自定义以下邮件：

- 注册验证邮件
- 密码重置邮件
- 订单通知
- 流量预警
- 套餐到期提醒

**切换语言后需重置模板**：界面切换到目标语言后，点击「重置为默认」，邮件模板会更新为对应语言版本。

> 重置会覆盖自定义内容，请提前备份。

---

## 系统设置

进入 **系统管理 → 系统设置**：

| 分类 | 配置项 |
|------|--------|
| 基本设置 | 站点名称、Logo、站点地址 |
| 注册设置 | 开放注册、邮箱验证、邀请码要求 |
| 订阅设置 | 订阅 URL、订阅格式配置 |
| 节点设置 | 节点通信密钥 |
| 安全设置 | 登录失败锁定、IP 黑名单 |

### 修改节点通信密钥

修改密钥后，所有节点上的 XrayM/XrayR 配置文件中的 `ApiKey` 都需要同步更新，否则节点将无法连接。

---

## 数据导出

以下页面支持导出数据：

- 用户列表 → 导出 CSV
- 订单列表 → 导出 CSV / Excel
- 财务报表 → 导出

---

## 审计日志

进入 **系统管理 → 审计日志** 查看：

- 用户登录记录（IP、时间）
- 管理员操作记录
- 关键操作（密码修改、余额变更等）

---

## 多语言切换与模板重置

1. 点击右上角语言切换器选择目标语言
2. 进入 **系统管理 → 邮件模板**，点击「重置为默认」
3. 进入 **系统管理 → 订阅模板**，点击「重置为默认」

这样所有模板内容将更新为所选语言版本。
