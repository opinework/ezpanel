# 管理員手冊

**語言**: [English](./05_admin-guide.md) | [简体中文](./05_admin-guide_CN.md) | 繁體中文 | [Русский](./05_admin-guide_RU.md) | [فارسی](./05_admin-guide_FA.md)

本文件面向 EzPanel 的管理員，介紹後台各功能模組的操作方法。

![管理後台](../images/dashboard.png)

---

## 首次登入

預設管理員帳號：

- **電子郵件**: `admin@opine.work`
- **密碼**: `admin123`

> **安全提醒**: 登入後請立即在「個人設定」中修改預設密碼和電子郵件，並開啟兩步驗證。

---

## 使用者管理

進入 **使用者管理 → 使用者清單**：

### 查看使用者

| 操作 | 說明 |
|------|------|
| 搜尋 | 支援按電子郵件、使用者 ID 搜尋 |
| 篩選 | 按狀態（正常 / 封禁）、方案篩選 |
| 匯出 | 匯出 CSV / Excel 格式的使用者資料 |

### 使用者操作

- **查看詳情**: 查看使用者的訂閱、訂單、流量、餘額等資訊
- **編輯**: 修改電子郵件、密碼、餘額、流量額度、到期時間
- **封禁 / 解封**: 禁止 / 允許使用者登入和使用訂閱
- **儲值餘額**: 直接為使用者帳戶儲值

### 手動重設密碼

在使用者詳情中可直接設定新密碼，無需驗證舊密碼。

---

## 方案管理

進入 **方案管理**：

### 建立方案

| 欄位 | 說明 |
|------|------|
| 方案名稱 | 顯示給使用者的名稱 |
| 流量額度 | 每個計費週期可用流量（GB） |
| 計費週期 | 月付 / 季付 / 半年 / 年付，每個週期單獨設定價格 |
| 庫存 | -1 表示無限，設定正整數則有庫存限制 |
| 裝置數限制 | 同時線上裝置數，0 表示不限制 |
| 速度限制 | 限速（Mbps），0 表示不限速 |
| 節點分組 | 該方案可訪問的節點分組 |
| 排序 | 數字越小越靠前 |
| 狀態 | 上架 / 下架 |

### 方案可見性

下架的方案不會顯示在使用者端，但已購買的使用者不受影響。

---

## 節點管理

進入 **系統管理 → 節點管理**：

### 建立節點

**基本設定**：

| 欄位 | 說明 |
|------|------|
| 節點名稱 | 顯示給使用者，支援 Emoji，如「🇭🇰 香港 01」 |
| 節點位址 | 節點伺服器 IP 或網域名稱 |
| 節點類型 | XrayM（推薦）/ XrayR |
| 節點分組 | 歸屬分組，影響方案訪問權限 |
| 速率限制 | 全域限速（Mbps），0 不限 |
| 裝置限制 | 同時線上裝置數，0 不限 |
| 排序 | 數字越小越靠前 |

**協議設定（XrayM）**：

點擊「快速新增協議」選擇預設組合，或手動新增協議：

- **傳輸層**: TCP / WebSocket / gRPC / HTTPUpgrade
- **安全層**: TLS / REALITY / 無
- **連接埠**: 各協議獨立連接埠

設定完成後，將節點 ID 和通訊密鑰填入伺服器上的 XrayM 設定檔，詳見 [節點對接](./03_node-setup_TW.md)。

### 節點監控

進入 **系統管理 → 健康檢查** 查看所有節點即時狀態：

- 節點線上 / 離線狀態
- CPU、記憶體、磁碟使用率
- 即時網路速率
- 當前線上使用者數

點擊節點可查看詳細歷史圖表，資料每 10 秒自動刷新。

> 節點監控僅支援 XrayM，XrayR 僅上報流量資料。

---

## 訂單管理（Pro 版）

進入 **訂單管理**：

| 操作 | 說明 |
|------|------|
| 查看訂單 | 支援按使用者、狀態、時間篩選 |
| 訂單詳情 | 查看付款記錄、方案資訊 |
| 退款 | 將訂單金額退還至使用者餘額 |
| 取消 | 取消未付款訂單 |
| 手動完成 | 對線下付款的訂單手動標記完成 |

---

## 優惠券管理（Pro 版）

進入 **行銷 → 優惠券**：

| 欄位 | 說明 |
|------|------|
| 優惠類型 | 固定金額 / 折扣百分比 |
| 使用限制 | 總使用次數 / 每人使用次數 |
| 適用方案 | 留空則適用全部方案 |
| 有效期 | 開始 / 結束時間 |
| 批量產生 | 可批量產生多個不同碼的優惠券 |

---

## 工單管理（Pro 版）

進入 **工單管理**：

- 查看所有使用者提交的工單
- 按狀態篩選（待處理 / 處理中 / 已關閉）
- 回覆工單，支援富文字
- 關閉工單或重新開啟

---

## 知識庫（Pro 版）

進入 **知識庫**：

- 建立 FAQ 文章，支援 Markdown / 富文字
- 分類管理
- 設定文章可見範圍（所有使用者 / 僅付費使用者）
- 使用者可在「說明」頁面查看

---

## 電子郵件系統

### 設定 SMTP

進入 **系統設定 → 電子郵件設定**：

| 設定項 | 說明 |
|--------|------|
| SMTP 伺服器 | 如 `smtp.gmail.com` |
| 連接埠 | 通常為 465（SSL）或 587（STARTTLS） |
| 使用者名稱 | 寄件電子郵件帳號 |
| 密碼 | 電子郵件密碼或應用程式專用密碼 |
| 寄件人名稱 | 顯示給收件人的寄件人名稱 |

填寫完成後點擊「發送測試郵件」驗證設定。

### 郵件範本

進入 **系統管理 → 郵件範本**，可自訂以下郵件：

- 註冊驗證郵件
- 密碼重設郵件
- 訂單通知
- 流量預警
- 方案到期提醒

**切換語言後需重設範本**：介面切換到目標語言後，點擊「重設為預設」，郵件範本會更新為對應語言版本。

> 重設會覆蓋自訂內容，請提前備份。

---

## 系統設定

進入 **系統管理 → 系統設定**：

| 分類 | 設定項 |
|------|--------|
| 基本設定 | 站台名稱、Logo、站台位址 |
| 註冊設定 | 開放註冊、電子郵件驗證、邀請碼要求 |
| 訂閱設定 | 訂閱 URL、訂閱格式設定 |
| 節點設定 | 節點通訊密鑰 |
| 安全設定 | 登入失敗鎖定、IP 黑名單 |

### 修改節點通訊密鑰

修改密鑰後，所有節點上的 XrayM/XrayR 設定檔中的 `ApiKey` 都需要同步更新，否則節點將無法連線。

---

## 資料匯出

以下頁面支援匯出資料：

- 使用者清單 → 匯出 CSV
- 訂單清單 → 匯出 CSV / Excel
- 財務報表 → 匯出

---

## 稽核日誌

進入 **系統管理 → 稽核日誌** 查看：

- 使用者登入記錄（IP、時間）
- 管理員操作記錄
- 關鍵操作（密碼修改、餘額變更等）

---

## 多語言切換與範本重設

1. 點擊右上角語言切換器選擇目標語言
2. 進入 **系統管理 → 郵件範本**，點擊「重設為預設」
3. 進入 **系統管理 → 訂閱範本**，點擊「重設為預設」

這樣所有範本內容將更新為所選語言版本。
